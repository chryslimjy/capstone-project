<!-- index.html -->

<!-- commit before proceeding-->

<!--test-->
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Speech Recognition Example</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.1/socket.io.js"></script>
</head>

<body>

  <h4>Custom Command Input</h4>

  <p>Command to update</p>
  <p>New Custom command</p>

  <script>
    // Connect to the Socket.IO server
    const socket = io('http://localhost:5000');
    const { ipcRenderer } = require('electron');
    const { wordsToNumbers } = require('words-to-numbers');
    

    let tagExist = false;

    // Listen for the 'connect' event, indicating successful connection
    socket.on('connect', () => {
      console.log('Connected to the Socket.IO server');
    });

    // Listen for the 'disconnect' event, indicating a disconnection
    socket.on('disconnect', (reason) => {
      console.log('Disconnected from the Socket.IO server. Reason:', reason);
    });




   

    // Listen for voice recognition from python
    socket.on('speech_recognition', (data) => {
      const recognizedText = data.text;
      console.log('Recognized Text:', recognizedText);

      //check if numtag exists. to be executed
      if (tagExist == true) {
      console.log('hello world. process number command');
      //function to detect the number and pass over to electron
      selectLink(recognizedText.toString());
    }


    //normal function
      executeCommand(recognizedText.toString());



      console.log('user said:', data);
    });





 




    socket.on('custom_event', (data) => {
      console.log('Custom Event Received:', data);
    });


    function selectLink(text) {
      //convert number string to integer
      const num = wordsToNumbers(text);
      ipcRenderer.send('goto-link', num);

    }




    //scripts for functions
    function executeCommand(text) {



      if (text == 'click') {
        ipcRenderer.send('execute-command-click');
        tagExist = true;
      }



      else if (text.includes('search') || text.includes('such')) {
        const searchQuery = text.substring('search'.length).trim();
        ipcRenderer.send('search-query', searchQuery)
      }

      else if (text.includes('input')) {
        const searchBar = text.substring('input'.length).trim();
        ipcRenderer.send('search-bar', searchBar);

      } else if (text == 'submit') {
        ipcRenderer.send('submit');
      }

      else if (text == 'down') {
        ipcRenderer.send('move-down');
      }

      else if (text == 'up') {
        ipcRenderer.send('move-up');
      }

      else if (text == 'bottom') {
        ipcRenderer.send('move-bottom');
      }

      else if (text == 'top') {
        ipcRenderer.send('move-top');
      }

      else {
        console.log('command not recognised');
      }

    }




  </script>
</body>

</html>